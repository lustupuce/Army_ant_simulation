<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Army ant simulation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Army ant simulation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>The first objective of this simulator is to try to replicate army ant bridge formation with flipping biped robots. The simulator can be used to help determining the parameters that influence the bridge formation. It also allows to try several basic rules on the simulated robots quickly. The simulator is working in 2D and combines 2 main libraries:</p><ul>
<li>The physics is handled by Box2D: <a href="https://box2d.org/about/">https://box2d.org/about/</a></li>
<li>The graphics portion is done using SFML: <a href="https://www.sfml-dev.org">https://www.sfml-dev.org</a></li>
</ul>
<p>However, both libraries does not use the same origin. Indeed. while the SFML (graphic) origin of the shapes is on the top left corner, the Box2D (physics) origin is set at the middle of the shape.<br />
 (cf image below) </p><div class="image">
<img src="box2d_vs_sfml.png" alt="box2d_vs_sfml.png"/>
</div>
<p> In addition, while in SFML all the positions are given in the world reference frame, the Box2D positions can be obtained either in the world reference frame our in their local reference frame (the shape from where the position is asked)<br />
 More importantly, the Box2D dimensions are given in meters while the SFML ones are given in pixel: to go from one to the other the conversion has to be carefully done Thus, if it is possible to do all the transformation from the Box2D position to the SFML ones manually, it is usually easier to proceed as following:</p><ul>
<li>Create the Box2D shape attached to a body</li>
<li>Get the position of its top left corner in the world reference frame from the local reference frame <br />
</li>
<li>Create the SFML corresponding shape at the position obtained previously<br />
 BE CAREFUL: the dimension also has to be converted from meters to pixel when going from Box2D to SFML<br />
<br />
 A concrete example to create a rectangle of width w and height h located at (posX, posY) is described below : <div class="fragment"><div class="line"><span class="comment">// Create the Box2D body (no fixture and shape attached yet)</span></div><div class="line">b2BodyDef rectBodyDef;</div><div class="line">rectBodyDef.position = b2Vec2(posX, posY);</div><div class="line">rectBody = world-&gt;CreateBody(&amp;rectBodyDef);</div><div class="line"></div><div class="line"><span class="comment">// Create the Box2D fixture and the rectangular shape that will be attached to the body</span></div><div class="line">b2PolygonShape rectShape;</div><div class="line">rectShape.SetAsBox(w/2,h/2);</div><div class="line">b2FixtureDef rectFixtureDef;</div><div class="line">rectFixtureDef.shape = &amp;rectShape;</div><div class="line">rectBody-&gt;CreateFixture(&amp;rectFixtureDef);</div><div class="line"></div><div class="line"><span class="comment">// Get the top left corner position in the world frame</span></div><div class="line">b2Vec2 topLeft = rect_box2D-&gt;GetWorldPoint(b2Vec2(-w/2,-h/2));</div><div class="line"></div><div class="line"><span class="comment">// Create the corresponding SFML shape</span></div><div class="line">sf::RectangleShape rectShape_sfml(sf::Vector2f(w*m_to_pix, h*m_to_pix));</div><div class="line">rectShape_sfml.setPosition(m_to_pix*topLeft.x,m_to_pix*topLeft.y);</div></div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="struct"></a>
Code overview</h1>
<p>To launch a simulation with existing terrains and without modifying the intrinsic properties of the robots or the controller, only the <a class="el" href="main_8cpp.html">main.cpp</a> and Demo.cpp file should be modified.</p>
<h1><a class="anchor" id="param"></a>
Configuration parameters</h1>
<p>The configuration parameters are defined in <a class="el" href="_config_8h.html" title="Implementation of the Configuration class used to parse the configuration file and the sConfig struct...">Config.h</a>. There is several way for the user to specify the input parameters. An easy way to do so when just launching the simulation from the IDE (eg:eclipse) is to modify the default parameters value in <a class="el" href="main_8cpp.html#a075854c1227ffd274988d62bb5c859a1">default_parameters(config::sConfig&amp; cfg)</a> (in <a class="el" href="main_8cpp.html">main.cpp</a>).<br />
 Another proper way to specify the configuration parameters is to write them in a config file and launch the simulation from the terminal specifying the configuration path : -cp &lt;path&gt;. An example of configuration file is given under examples/config_template.cfg.<br />
 However, if one want to launch a batch of simulation with different values for the parameters. It might be easier to specify the parameters values individually with the correct entry command. The list of command can be obtain when launching the simulation from the terminal: "./Simulation_v2 -h " or "./Simulation_v2 --help" <br />
 From the source code, the commands are summarized in <a class="el" href="main_8cpp.html#a97ee70a8770dc30d06c744b24eb2fcfc">help()</a> (in <a class="el" href="main_8cpp.html">main.cpp</a>)</p>
<h1><a class="anchor" id="terrain"></a>
Create the terrain</h1>
<p>Different type of terrain are already implemented. <br />
 The Default terrain is the one implemented in the parent class <a class="el" href="class_terrain.html">Terrain</a>. It is a simple horizontal ground.<br />
 The <a class="el" href="class_box_terrain.html">BoxTerrain</a> is an horizontal rectangular box.<br />
 The <a class="el" href="class_vterrain.html">Vterrain</a> is an horizontal ground with a V-shaped gap.<br />
 The <a class="el" href="class_v2_b_l_terrain.html">V2BLTerrain</a> is similar to the <a class="el" href="class_vterrain.html">Vterrain</a> but the bottom of the V-shaped gap is truncated so that the width corresponds to 2 body-length.<br />
 The <a class="el" href="class_ramp.html">Ramp</a> is a single descending ramp (with a 90° angle).<br />
 The <a class="el" href="class_v_stepper.html">VStepper</a> is a more complex terrain where the obstacle is kind of a stepper but with sharper angle (angle &lt; 90°).<br />
 </p>
<h2><a class="anchor" id="ex_terrain"></a>
Existing terrain</h2>
<p>To select which terrain should be used in the simulation, it has to be specified in the <a class="el" href="_demo_8h.html" title="Implementation of the Demo class and the MyContactListener_v2 class. ">Demo.h</a> file: the type of the Demo::m_terrain member has to be adapted. Once the terrain has been chosen, the terrain Parameters (cf sTerrain struct in <a class="el" href="_config_8h.html" title="Implementation of the Configuration class used to parse the configuration file and the sConfig struct...">Config.h</a>) can be adjusted using different methods described in <a class="el" href="index.html#param">Configuration parameters</a></p>
<h2><a class="anchor" id="new_terrain"></a>
Create new terrain</h2>
<p>If the creation of a new terrain is necessary, the new class should inherit from the global <a class="el" href="class_terrain.html">Terrain</a> class. then the newly created .h file should be included in <a class="el" href="_demo_8h.html" title="Implementation of the Demo class and the MyContactListener_v2 class. ">Demo.h</a>.<br />
 It might be necessary to re-implement the getScale() function depending on the parameters so that the whole terrain fits the window size.<br />
</p>
<h1><a class="anchor" id="rob"></a>
Create robots</h1>
<h1><a class="anchor" id="rules"></a>
Change the rules</h1>
<p>etc... </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
